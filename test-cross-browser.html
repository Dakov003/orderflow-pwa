<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cross-Browser - OrderFlow PWA</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .content {
            padding: 30px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        .test-card:hover {
            border-color: #0ea5e9;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .test-button {
            background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3);
        }
        .test-button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .results {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .browser-info {
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .compatibility-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .compatibility-table th,
        .compatibility-table td {
            border: 1px solid #e2e8f0;
            padding: 8px 12px;
            text-align: left;
        }
        .compatibility-table th {
            background: #f8fafc;
            font-weight: 600;
        }
        .status-supported {
            color: #10b981;
            font-weight: bold;
        }
        .status-partial {
            color: #f59e0b;
            font-weight: bold;
        }
        .status-unsupported {
            color: #ef4444;
            font-weight: bold;
        }
        .app-frame {
            width: 100%;
            height: 600px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌐 Test Cross-Browser - OrderFlow PWA</h1>
            <p>Testează compatibilitatea cu diferite browsere și dispozitive</p>
        </div>

        <div class="content">
            <div class="browser-info">
                <h3>🔍 Informații Browser Curent</h3>
                <div id="browserInfo">
                    <p>Se încarcă informațiile browser-ului...</p>
                </div>
            </div>

            <div class="test-grid">
                <div class="test-card">
                    <h3>🌐 Browser Detection</h3>
                    <p>Detectează browser-ul și versiunea</p>
                    <button class="test-button" onclick="detectBrowser()">Detectează Browser</button>
                    <button class="test-button" onclick="testBrowserFeatures()">Testează Funcții</button>
                    <div class="results" id="browserResults"></div>
                </div>

                <div class="test-card">
                    <h3>📱 Device Detection</h3>
                    <p>Detectează tipul de dispozitiv</p>
                    <button class="test-button" onclick="detectDevice()">Detectează Dispozitiv</button>
                    <button class="test-button" onclick="testResponsive()">Testează Responsive</button>
                    <div class="results" id="deviceResults"></div>
                </div>

                <div class="test-card">
                    <h3>🔧 Feature Support</h3>
                    <p>Testează suportul pentru funcții moderne</p>
                    <button class="test-button" onclick="testModernFeatures()">Testează Funcții Moderne</button>
                    <button class="test-button" onclick="testPWAFeatures()">Testează PWA</button>
                    <div class="results" id="featureResults"></div>
                </div>

                <div class="test-card">
                    <h3>🎨 CSS Support</h3>
                    <p>Testează suportul pentru CSS modern</p>
                    <button class="test-button" onclick="testCSSSupport()">Testează CSS</button>
                    <button class="test-button" onclick="testTailwindSupport()">Testează Tailwind</button>
                    <div class="results" id="cssResults"></div>
                </div>

                <div class="test-card">
                    <h3>⚡ JavaScript Support</h3>
                    <p>Testează suportul pentru JavaScript modern</p>
                    <button class="test-button" onclick="testJavaScriptSupport()">Testează JavaScript</button>
                    <button class="test-button" onclick="testES6Features()">Testează ES6+</button>
                    <div class="results" id="jsResults"></div>
                </div>

                <div class="test-card">
                    <h3>🔒 Security & Privacy</h3>
                    <p>Testează funcțiile de securitate</p>
                    <button class="test-button" onclick="testSecurityFeatures()">Testează Securitate</button>
                    <button class="test-button" onclick="testPrivacyFeatures()">Testează Privacy</button>
                    <div class="results" id="securityResults"></div>
                </div>
            </div>

            <div class="test-card">
                <h2>📊 Tabel Compatibilitate</h2>
                <table class="compatibility-table" id="compatibilityTable">
                    <thead>
                        <tr>
                            <th>Funcție</th>
                            <th>Chrome</th>
                            <th>Firefox</th>
                            <th>Safari</th>
                            <th>Edge</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="compatibilityBody">
                        <tr><td colspan="6">Se încarcă datele de compatibilitate...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="test-card">
                <h2>🌐 Aplicația OrderFlow</h2>
                <p>Testează aplicația în browser-ul curent:</p>
                <iframe src="http://localhost:4173" class="app-frame" id="appFrame"></iframe>
            </div>

            <div class="test-card">
                <h2>📊 Raport Cross-Browser</h2>
                <button class="test-button" onclick="generateCrossBrowserReport()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                    Generează Raport
                </button>
                <div class="results" id="crossBrowserReport"></div>
            </div>
        </div>
    </div>

    <script>
        let crossBrowserResults = {
            browser: {},
            device: {},
            features: {},
            css: {},
            javascript: {},
            security: {}
        };

        function detectBrowser() {
            const results = document.getElementById('browserResults');
            let result = '🌐 Detectare Browser:\n';
            
            try {
                const userAgent = navigator.userAgent;
                let browserName = 'Unknown';
                let browserVersion = 'Unknown';
                
                // Detectează Chrome
                if (userAgent.includes('Chrome') && !userAgent.includes('Edge')) {
                    browserName = 'Chrome';
                    const match = userAgent.match(/Chrome\/(\d+)/);
                    browserVersion = match ? match[1] : 'Unknown';
                }
                // Detectează Firefox
                else if (userAgent.includes('Firefox')) {
                    browserName = 'Firefox';
                    const match = userAgent.match(/Firefox\/(\d+)/);
                    browserVersion = match ? match[1] : 'Unknown';
                }
                // Detectează Safari
                else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {
                    browserName = 'Safari';
                    const match = userAgent.match(/Version\/(\d+)/);
                    browserVersion = match ? match[1] : 'Unknown';
                }
                // Detectează Edge
                else if (userAgent.includes('Edge')) {
                    browserName = 'Edge';
                    const match = userAgent.match(/Edge\/(\d+)/);
                    browserVersion = match ? match[1] : 'Unknown';
                }
                
                result += `🌐 Browser: ${browserName}\n`;
                result += `📱 Versiune: ${browserVersion}\n`;
                result += `🖥️ User Agent: ${userAgent}\n`;
                
                // Detectează platforma
                const platform = navigator.platform;
                result += `💻 Platformă: ${platform}\n`;
                
                // Detectează limba
                const language = navigator.language;
                result += `🗣️ Limbă: ${language}\n`;
                
                crossBrowserResults.browser.name = browserName;
                crossBrowserResults.browser.version = browserVersion;
                crossBrowserResults.browser.platform = platform;
                crossBrowserResults.browser.language = language;
                
                // Actualizează informațiile browser-ului
                document.getElementById('browserInfo').innerHTML = `
                    <p><strong>Browser:</strong> ${browserName} ${browserVersion}</p>
                    <p><strong>Platformă:</strong> ${platform}</p>
                    <p><strong>Limbă:</strong> ${language}</p>
                    <p><strong>User Agent:</strong> ${userAgent}</p>
                `;
                
            } catch (error) {
                result += `❌ Eroare la detectarea browser-ului: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testBrowserFeatures() {
            const results = document.getElementById('browserResults');
            let result = results.innerHTML + '\n\n🔧 Testare Funcții Browser:\n';
            
            try {
                const features = {
                    'Service Worker': 'serviceWorker' in navigator,
                    'Push Notifications': 'PushManager' in window,
                    'Web App Manifest': 'onbeforeinstallprompt' in window,
                    'IndexedDB': 'indexedDB' in window,
                    'WebGL': !!document.createElement('canvas').getContext('webgl'),
                    'WebGL2': !!document.createElement('canvas').getContext('webgl2'),
                    'WebRTC': 'RTCPeerConnection' in window,
                    'WebSocket': 'WebSocket' in window,
                    'Fetch API': 'fetch' in window,
                    'Promise': 'Promise' in window,
                    'Async/Await': (async () => {}).constructor.name === 'AsyncFunction',
                    'Arrow Functions': (() => {}).constructor.name === 'Function',
                    'Template Literals': '`test`'.includes('test'),
                    'Destructuring': (() => { try { eval('const {a} = {}'); return true; } catch(e) { return false; } })(),
                    'Classes': (() => { try { eval('class Test {}'); return true; } catch(e) { return false; } })(),
                    'Modules': 'import' in window,
                    'Local Storage': 'localStorage' in window,
                    'Session Storage': 'sessionStorage' in window,
                    'Geolocation': 'geolocation' in navigator,
                    'Camera': 'mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices
                };
                
                let supportedCount = 0;
                Object.entries(features).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(features).length) * 100);
                result += `\n📊 Suport total: ${supportPercentage}% (${supportedCount}/${Object.keys(features).length})\n`;
                
                crossBrowserResults.browser.features = features;
                crossBrowserResults.browser.supportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea funcțiilor: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function detectDevice() {
            const results = document.getElementById('deviceResults');
            let result = '📱 Detectare Dispozitiv:\n';
            
            try {
                // Detectează tipul de dispozitiv
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                const isTablet = /iPad|Android/i.test(navigator.userAgent) && !/Mobile/i.test(navigator.userAgent);
                const isDesktop = !isMobile && !isTablet;
                
                result += `📱 Mobile: ${isMobile ? '✅' : '❌'}\n`;
                result += `📱 Tablet: ${isTablet ? '✅' : '❌'}\n`;
                result += `🖥️ Desktop: ${isDesktop ? '✅' : '❌'}\n`;
                
                // Detectează dimensiunea ecranului
                const screenWidth = window.screen.width;
                const screenHeight = window.screen.height;
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                result += `📐 Ecran: ${screenWidth}x${screenHeight}\n`;
                result += `📐 Fereastră: ${windowWidth}x${windowHeight}\n`;
                
                // Detectează orientarea
                const orientation = screenWidth > screenHeight ? 'Landscape' : 'Portrait';
                result += `🔄 Orientare: ${orientation}\n`;
                
                // Detectează pixel ratio
                const pixelRatio = window.devicePixelRatio || 1;
                result += `🔍 Pixel Ratio: ${pixelRatio}\n`;
                
                // Detectează touch support
                const touchSupport = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                result += `👆 Touch Support: ${touchSupport ? '✅' : '❌'}\n`;
                
                crossBrowserResults.device.isMobile = isMobile;
                crossBrowserResults.device.isTablet = isTablet;
                crossBrowserResults.device.isDesktop = isDesktop;
                crossBrowserResults.device.screenSize = { width: screenWidth, height: screenHeight };
                crossBrowserResults.device.windowSize = { width: windowWidth, height: windowHeight };
                crossBrowserResults.device.orientation = orientation;
                crossBrowserResults.device.pixelRatio = pixelRatio;
                crossBrowserResults.device.touchSupport = touchSupport;
                
            } catch (error) {
                result += `❌ Eroare la detectarea dispozitivului: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testResponsive() {
            const results = document.getElementById('deviceResults');
            let result = results.innerHTML + '\n\n📱 Testare Responsive:\n';
            
            try {
                const iframe = document.getElementById('appFrame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // Testează viewport meta tag
                const viewport = iframeDoc.querySelector('meta[name="viewport"]');
                if (viewport) {
                    result += `✅ Viewport meta tag: ${viewport.content}\n`;
                } else {
                    result += '❌ Viewport meta tag lipsă\n';
                }
                
                // Testează media queries
                const mediaQueries = [
                    '(max-width: 768px)',
                    '(max-width: 1024px)',
                    '(min-width: 1024px)',
                    '(orientation: portrait)',
                    '(orientation: landscape)'
                ];
                
                mediaQueries.forEach(mq => {
                    const matches = window.matchMedia(mq).matches;
                    result += `ℹ️ ${mq}: ${matches ? 'activ' : 'inactiv'}\n`;
                });
                
                // Testează elementele responsive
                const responsiveElements = iframeDoc.querySelectorAll('[class*="sm:"], [class*="md:"], [class*="lg:"], [class*="xl:"]');
                result += `✅ Elemente responsive: ${responsiveElements.length}\n`;
                
                crossBrowserResults.device.responsiveElements = responsiveElements.length;
                
            } catch (error) {
                result += `❌ Eroare la testarea responsive: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testModernFeatures() {
            const results = document.getElementById('featureResults');
            let result = '🔧 Testare Funcții Moderne:\n';
            
            try {
                const modernFeatures = {
                    'CSS Grid': CSS.supports('display', 'grid'),
                    'CSS Flexbox': CSS.supports('display', 'flex'),
                    'CSS Custom Properties': CSS.supports('--custom-property', 'value'),
                    'CSS Transforms': CSS.supports('transform', 'translateX(10px)'),
                    'CSS Animations': CSS.supports('animation', 'name 1s'),
                    'CSS Transitions': CSS.supports('transition', 'all 1s'),
                    'CSS Filters': CSS.supports('filter', 'blur(5px)'),
                    'CSS Backdrop Filter': CSS.supports('backdrop-filter', 'blur(5px)'),
                    'CSS Clip Path': CSS.supports('clip-path', 'circle(50%)'),
                    'CSS Mask': CSS.supports('mask', 'url(#mask)'),
                    'CSS Scroll Snap': CSS.supports('scroll-snap-type', 'x mandatory'),
                    'CSS Container Queries': CSS.supports('container-type', 'inline-size'),
                    'CSS Logical Properties': CSS.supports('margin-inline-start', '10px'),
                    'CSS Subgrid': CSS.supports('display', 'subgrid'),
                    'CSS Cascade Layers': CSS.supports('@layer', 'test')
                };
                
                let supportedCount = 0;
                Object.entries(modernFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(modernFeatures).length) * 100);
                result += `\n📊 Suport CSS modern: ${supportPercentage}%\n`;
                
                crossBrowserResults.features.modern = modernFeatures;
                crossBrowserResults.features.modernSupportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea funcțiilor moderne: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testPWAFeatures() {
            const results = document.getElementById('featureResults');
            let result = results.innerHTML + '\n\n📱 Testare Funcții PWA:\n';
            
            try {
                const pwaFeatures = {
                    'Service Worker': 'serviceWorker' in navigator,
                    'Push Notifications': 'PushManager' in window,
                    'Background Sync': 'serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype,
                    'Web App Manifest': 'onbeforeinstallprompt' in window,
                    'Add to Home Screen': 'onbeforeinstallprompt' in window,
                    'Offline Support': 'serviceWorker' in navigator,
                    'Cache API': 'caches' in window,
                    'IndexedDB': 'indexedDB' in window,
                    'Web Share API': 'share' in navigator,
                    'Web Share Target': 'serviceWorker' in navigator,
                    'Payment Request API': 'PaymentRequest' in window,
                    'Web Bluetooth': 'bluetooth' in navigator,
                    'Web USB': 'usb' in navigator,
                    'Web NFC': 'nfc' in navigator,
                    'Web Serial': 'serial' in navigator
                };
                
                let supportedCount = 0;
                Object.entries(pwaFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(pwaFeatures).length) * 100);
                result += `\n📊 Suport PWA: ${supportPercentage}%\n`;
                
                crossBrowserResults.features.pwa = pwaFeatures;
                crossBrowserResults.features.pwaSupportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea funcțiilor PWA: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testCSSSupport() {
            const results = document.getElementById('cssResults');
            let result = '🎨 Testare Suport CSS:\n';
            
            try {
                const cssFeatures = {
                    'CSS Grid': CSS.supports('display', 'grid'),
                    'CSS Flexbox': CSS.supports('display', 'flex'),
                    'CSS Custom Properties': CSS.supports('--custom-property', 'value'),
                    'CSS Transforms': CSS.supports('transform', 'translateX(10px)'),
                    'CSS Animations': CSS.supports('animation', 'name 1s'),
                    'CSS Transitions': CSS.supports('transition', 'all 1s'),
                    'CSS Filters': CSS.supports('filter', 'blur(5px)'),
                    'CSS Backdrop Filter': CSS.supports('backdrop-filter', 'blur(5px)'),
                    'CSS Clip Path': CSS.supports('clip-path', 'circle(50%)'),
                    'CSS Mask': CSS.supports('mask', 'url(#mask)'),
                    'CSS Scroll Snap': CSS.supports('scroll-snap-type', 'x mandatory'),
                    'CSS Container Queries': CSS.supports('container-type', 'inline-size'),
                    'CSS Logical Properties': CSS.supports('margin-inline-start', '10px'),
                    'CSS Subgrid': CSS.supports('display', 'subgrid'),
                    'CSS Cascade Layers': CSS.supports('@layer', 'test')
                };
                
                let supportedCount = 0;
                Object.entries(cssFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(cssFeatures).length) * 100);
                result += `\n📊 Suport CSS: ${supportPercentage}%\n`;
                
                crossBrowserResults.css.features = cssFeatures;
                crossBrowserResults.css.supportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea CSS: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testTailwindSupport() {
            const results = document.getElementById('cssResults');
            let result = results.innerHTML + '\n\n🎨 Testare Suport Tailwind:\n';
            
            try {
                const iframe = document.getElementById('appFrame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // Testează clasele Tailwind
                const tailwindClasses = [
                    'bg-blue-500',
                    'text-white',
                    'p-4',
                    'm-2',
                    'rounded-lg',
                    'shadow-md',
                    'hover:bg-blue-600',
                    'focus:outline-none',
                    'transition',
                    'duration-200'
                ];
                
                let workingClasses = 0;
                tailwindClasses.forEach(className => {
                    const element = iframeDoc.createElement('div');
                    element.className = className;
                    iframeDoc.body.appendChild(element);
                    
                    const computedStyle = window.getComputedStyle(element);
                    if (computedStyle.backgroundColor || computedStyle.color || computedStyle.padding) {
                        workingClasses++;
                    }
                    
                    iframeDoc.body.removeChild(element);
                });
                
                result += `✅ Clase Tailwind funcționale: ${workingClasses}/${tailwindClasses.length}\n`;
                
                // Testează elementele cu clase Tailwind
                const tailwindElements = iframeDoc.querySelectorAll('[class*="bg-"], [class*="text-"], [class*="p-"], [class*="m-"]');
                result += `✅ Elemente cu clase Tailwind: ${tailwindElements.length}\n`;
                
                crossBrowserResults.css.tailwindClasses = workingClasses;
                crossBrowserResults.css.tailwindElements = tailwindElements.length;
                
            } catch (error) {
                result += `❌ Eroare la testarea Tailwind: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testJavaScriptSupport() {
            const results = document.getElementById('jsResults');
            let result = '⚡ Testare Suport JavaScript:\n';
            
            try {
                const jsFeatures = {
                    'ES6 Arrow Functions': (() => {}).constructor.name === 'Function',
                    'ES6 Template Literals': '`test`'.includes('test'),
                    'ES6 Destructuring': (() => { try { eval('const {a} = {}'); return true; } catch(e) { return false; } })(),
                    'ES6 Classes': (() => { try { eval('class Test {}'); return true; } catch(e) { return false; } })(),
                    'ES6 Modules': 'import' in window,
                    'ES6 Promises': 'Promise' in window,
                    'ES6 Async/Await': (async () => {}).constructor.name === 'AsyncFunction',
                    'ES6 Generators': (function* () {}).constructor.name === 'GeneratorFunction',
                    'ES6 Symbols': 'Symbol' in window,
                    'ES6 Map': 'Map' in window,
                    'ES6 Set': 'Set' in window,
                    'ES6 WeakMap': 'WeakMap' in window,
                    'ES6 WeakSet': 'WeakSet' in window,
                    'ES6 Proxy': 'Proxy' in window,
                    'ES6 Reflect': 'Reflect' in window,
                    'ES7 Array.includes': Array.prototype.includes,
                    'ES7 Exponentiation': (() => { try { eval('2 ** 3'); return true; } catch(e) { return false; } })(),
                    'ES8 Object.entries': 'entries' in Object,
                    'ES8 Object.values': 'values' in Object,
                    'ES8 String.padStart': 'padStart' in String.prototype,
                    'ES8 String.padEnd': 'padEnd' in String.prototype,
                    'ES9 Async Iteration': (() => { try { eval('async function* test() {}'); return true; } catch(e) { return false; } })(),
                    'ES10 Array.flat': 'flat' in Array.prototype,
                    'ES10 Array.flatMap': 'flatMap' in Array.prototype,
                    'ES10 Object.fromEntries': 'fromEntries' in Object,
                    'ES10 String.trimStart': 'trimStart' in String.prototype,
                    'ES10 String.trimEnd': 'trimEnd' in String.prototype
                };
                
                let supportedCount = 0;
                Object.entries(jsFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(jsFeatures).length) * 100);
                result += `\n📊 Suport JavaScript: ${supportPercentage}%\n`;
                
                crossBrowserResults.javascript.features = jsFeatures;
                crossBrowserResults.javascript.supportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea JavaScript: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testES6Features() {
            const results = document.getElementById('jsResults');
            let result = results.innerHTML + '\n\n⚡ Testare Funcții ES6+:\n';
            
            try {
                // Testează funcțiile ES6+ specifice
                const es6Features = {
                    'Arrow Functions': (() => {}).constructor.name === 'Function',
                    'Template Literals': '`test`'.includes('test'),
                    'Destructuring': (() => { try { eval('const {a} = {}'); return true; } catch(e) { return false; } })(),
                    'Classes': (() => { try { eval('class Test {}'); return true; } catch(e) { return false; } })(),
                    'Modules': 'import' in window,
                    'Promises': 'Promise' in window,
                    'Async/Await': (async () => {}).constructor.name === 'AsyncFunction',
                    'Generators': (function* () {}).constructor.name === 'GeneratorFunction',
                    'Symbols': 'Symbol' in window,
                    'Map': 'Map' in window,
                    'Set': 'Set' in window,
                    'WeakMap': 'WeakMap' in window,
                    'WeakSet': 'WeakSet' in window,
                    'Proxy': 'Proxy' in window,
                    'Reflect': 'Reflect' in window
                };
                
                let supportedCount = 0;
                Object.entries(es6Features).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(es6Features).length) * 100);
                result += `\n📊 Suport ES6+: ${supportPercentage}%\n`;
                
                crossBrowserResults.javascript.es6Features = es6Features;
                crossBrowserResults.javascript.es6SupportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea ES6+: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testSecurityFeatures() {
            const results = document.getElementById('securityResults');
            let result = '🔒 Testare Funcții Securitate:\n';
            
            try {
                const securityFeatures = {
                    'HTTPS': location.protocol === 'https:',
                    'Secure Context': window.isSecureContext,
                    'CSP Support': 'SecurityPolicyViolationEvent' in window,
                    'CORS Support': 'XMLHttpRequest' in window,
                    'Same-Origin Policy': window.location.origin === window.location.origin,
                    'Content Security Policy': 'SecurityPolicyViolationEvent' in window,
                    'Subresource Integrity': 'integrity' in document.createElement('script'),
                    'Referrer Policy': 'referrerPolicy' in document.createElement('a'),
                    'Mixed Content': location.protocol === 'https:' ? 'Secure' : 'Insecure',
                    'Web Crypto API': 'crypto' in window && 'subtle' in window.crypto,
                    'Web Authentication API': 'PublicKeyCredential' in window,
                    'Permissions API': 'permissions' in navigator,
                    'Feature Policy': 'featurePolicy' in document,
                    'Trusted Types': 'trustedTypes' in window,
                    'Cross-Origin Isolation': 'crossOriginIsolated' in window
                };
                
                let supportedCount = 0;
                Object.entries(securityFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(securityFeatures).length) * 100);
                result += `\n📊 Suport Securitate: ${supportPercentage}%\n`;
                
                crossBrowserResults.security.features = securityFeatures;
                crossBrowserResults.security.supportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea securității: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function testPrivacyFeatures() {
            const results = document.getElementById('securityResults');
            let result = results.innerHTML + '\n\n🔒 Testare Funcții Privacy:\n';
            
            try {
                const privacyFeatures = {
                    'Do Not Track': navigator.doNotTrack === '1',
                    'Cookie Consent': 'cookieConsent' in window,
                    'GDPR Compliance': 'gdpr' in window,
                    'Privacy Mode': 'privacy' in navigator,
                    'Incognito Mode': 'incognito' in window,
                    'Private Browsing': 'private' in window,
                    'Tracking Protection': 'tracking' in navigator,
                    'Ad Blocking': 'adblock' in window,
                    'Script Blocking': 'scriptblock' in window,
                    'Content Blocking': 'contentblock' in window
                };
                
                let supportedCount = 0;
                Object.entries(privacyFeatures).forEach(([feature, supported]) => {
                    const status = supported ? '✅' : '❌';
                    result += `${status} ${feature}\n`;
                    if (supported) supportedCount++;
                });
                
                const supportPercentage = Math.round((supportedCount / Object.keys(privacyFeatures).length) * 100);
                result += `\n📊 Suport Privacy: ${supportPercentage}%\n`;
                
                crossBrowserResults.security.privacyFeatures = privacyFeatures;
                crossBrowserResults.security.privacySupportPercentage = supportPercentage;
                
            } catch (error) {
                result += `❌ Eroare la testarea privacy: ${error.message}\n`;
            }
            
            results.innerHTML = result;
        }

        function updateCompatibilityTable() {
            const tbody = document.getElementById('compatibilityBody');
            tbody.innerHTML = '';
            
            const features = [
                { name: 'Service Worker', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'Push Notifications', chrome: true, firefox: true, safari: false, edge: true },
                { name: 'Web App Manifest', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'IndexedDB', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'WebGL', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'WebGL2', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'WebRTC', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'Fetch API', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'Promise', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'Async/Await', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'CSS Grid', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'CSS Flexbox', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'CSS Custom Properties', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'CSS Transforms', chrome: true, firefox: true, safari: true, edge: true },
                { name: 'CSS Animations', chrome: true, firefox: true, safari: true, edge: true }
            ];
            
            features.forEach(feature => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${feature.name}</td>
                    <td class="status-supported">${feature.chrome ? '✅' : '❌'}</td>
                    <td class="status-supported">${feature.firefox ? '✅' : '❌'}</td>
                    <td class="status-supported">${feature.safari ? '✅' : '❌'}</td>
                    <td class="status-supported">${feature.edge ? '✅' : '❌'}</td>
                    <td class="status-supported">${feature.chrome && feature.firefox && feature.safari && feature.edge ? '✅' : '⚠️'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function generateCrossBrowserReport() {
            const results = document.getElementById('crossBrowserReport');
            let report = '📊 RAPORT CROSS-BROWSER - ORDERFLOW PWA\n';
            report += '='.repeat(60) + '\n\n';
            
            report += `📅 Data: ${new Date().toLocaleString('ro-RO')}\n`;
            report += `🖥️ Browser: ${navigator.userAgent}\n`;
            report += `📱 Rezoluție: ${window.innerWidth}x${window.innerHeight}\n\n`;
            
            report += '📊 REZULTATE TESTE:\n';
            report += '-'.repeat(30) + '\n';
            
            // Browser Info
            report += '\n🌐 BROWSER:\n';
            report += `Nume: ${crossBrowserResults.browser.name || 'N/A'}\n`;
            report += `Versiune: ${crossBrowserResults.browser.version || 'N/A'}\n`;
            report += `Platformă: ${crossBrowserResults.browser.platform || 'N/A'}\n`;
            report += `Limbă: ${crossBrowserResults.browser.language || 'N/A'}\n`;
            report += `Suport funcții: ${crossBrowserResults.browser.supportPercentage || 'N/A'}%\n`;
            
            // Device Info
            report += '\n📱 DISPOZITIV:\n';
            report += `Mobile: ${crossBrowserResults.device.isMobile ? '✅' : '❌'}\n`;
            report += `Tablet: ${crossBrowserResults.device.isTablet ? '✅' : '❌'}\n`;
            report += `Desktop: ${crossBrowserResults.device.isDesktop ? '✅' : '❌'}\n`;
            report += `Touch Support: ${crossBrowserResults.device.touchSupport ? '✅' : '❌'}\n`;
            report += `Orientare: ${crossBrowserResults.device.orientation || 'N/A'}\n`;
            
            // Features
            report += '\n🔧 FUNCȚII:\n';
            report += `Suport modern: ${crossBrowserResults.features.modernSupportPercentage || 'N/A'}%\n`;
            report += `Suport PWA: ${crossBrowserResults.features.pwaSupportPercentage || 'N/A'}%\n`;
            
            // CSS
            report += '\n🎨 CSS:\n';
            report += `Suport CSS: ${crossBrowserResults.css.supportPercentage || 'N/A'}%\n`;
            report += `Clase Tailwind: ${crossBrowserResults.css.tailwindClasses || 'N/A'}\n`;
            report += `Elemente Tailwind: ${crossBrowserResults.css.tailwindElements || 'N/A'}\n`;
            
            // JavaScript
            report += '\n⚡ JAVASCRIPT:\n';
            report += `Suport JS: ${crossBrowserResults.javascript.supportPercentage || 'N/A'}%\n`;
            report += `Suport ES6+: ${crossBrowserResults.javascript.es6SupportPercentage || 'N/A'}%\n`;
            
            // Security
            report += '\n🔒 SECURITATE:\n';
            report += `Suport securitate: ${crossBrowserResults.security.supportPercentage || 'N/A'}%\n`;
            report += `Suport privacy: ${crossBrowserResults.security.privacySupportPercentage || 'N/A'}%\n`;
            
            report += '\n🎯 RECOMANDĂRI:\n';
            report += '-'.repeat(20) + '\n';
            report += '1. Testează pe toate browserele majore\n';
            report += '2. Verifică compatibilitatea cu versiunile vechi\n';
            report += '3. Implementează fallback-uri pentru funcții noi\n';
            report += '4. Testează pe dispozitive mobile și desktop\n';
            report += '5. Verifică funcționarea în modul offline\n';
            
            results.innerHTML = report;
        }

        // Inițializare
        window.addEventListener('load', function() {
            detectBrowser();
            detectDevice();
            testBrowserFeatures();
            testModernFeatures();
            testCSSSupport();
            testJavaScriptSupport();
            testSecurityFeatures();
            updateCompatibilityTable();
        });
    </script>
</body>
</html>
